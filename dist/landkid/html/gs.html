<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="../css/normalize.css"/>
    <link rel="stylesheet" href="../css/grid.css"/>
    <link rel="stylesheet" href="../css/gs.css"/>
</head>
<body>

<ul class="scroll-navi">
    <li><a href="#">C1</a></li>
    <li><a href="#">C2</a></li>
    <li><a href="#">C3</a></li>
</ul>

<div class="container">
    <div class="col-12 content-title">Contents1</div>

    <div class="col-1">column</div>
    <div class="col-11">column</div>

    <div class="col-2">column</div>
    <div class="col-10">column</div>

    <div class="col-3">column</div>
    <div class="col-9">column</div>

    <div class="col-4">column</div>
    <div class="col-8">column</div>

    <div class="col-5">column</div>
    <div class="col-7">column</div>

    <div class="col-6">column</div>
    <div class="col-6">column</div>
</div>

<div class="container">

    <div class="col-12 content-title">Contents2</div>
    <div class="col-7">column</div>
    <div class="col-5">column</div>

    <div class="col-8">column</div>
    <div class="col-4">column</div>

    <div class="col-9">column</div>
    <div class="col-3">column</div>

    <div class="col-10">column</div>
    <div class="col-2">column</div>

    <div class="col-11">column</div>
    <div class="col-1">column</div>

    <div class="col-4">column</div>
    <div class="col-4">column</div>
    <div class="col-4">column</div>
</div>
<div class="container">

    <div class="col-12 content-title ">Contents3</div>

    <div class="col-3">column</div>
    <div class="col-3">column</div>
    <div class="col-3">column</div>
    <div class="col-3">column</div>

    <div class="col-2">column</div>
    <div class="col-2">column</div>
    <div class="col-2">column</div>
    <div class="col-2">column</div>
    <div class="col-2">column</div>
    <div class="col-2">column</div>

    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
    <div class="col-1">column</div>
</div>

<table class="container">
    <thead>
        <tr class="col-12 table-header">
            <th class="col-2">H1</th>
            <th class="col-2">H2</th>
            <th class="col-2">H3</th>
            <th class="col-2">H4</th>
            <th class="col-2">H5</th>
            <th class="col-2">H6</th>
        </tr>
    </thead>
    <tbody>
        <tr class="col-12 table-row">
            <td class="col-2"><span class="label">H1:</span><span>row 1</span></td>
            <td class="col-2"><span class="label">H2:</span><span>row 2</span></td>
            <td class="col-2"><span class="label">H3:</span><span>row 3</span></td>
            <td class="col-2"><span class="label">H4:</span><span>row 4</span></td>
            <td class="col-2"><span class="label">H5:</span><span>row 5</span></td>
            <td class="col-2"><span class="label">H6:</span><span>row 6</span></td>
        </tr>
        <tr class="col-12 table-row">
            <td class="col-2"><span class="label">H1:</span><span>row 1</span></td>
            <td class="col-2"><span class="label">H2:</span><span>row 2</span></td>
            <td class="col-2"><span class="label">H3:</span><span>row 3</span></td>
            <td class="col-2"><span class="label">H4:</span><span>row 4</span></td>
            <td class="col-2"><span class="label">H5:</span><span>row 5</span></td>
            <td class="col-2"><span class="label">H6:</span><span>row 6</span></td>
        </tr>
        <tr class="col-12 table-row">
            <td class="col-2"><span class="label">H1:</span><span>row 1</span></td>
            <td class="col-2"><span class="label">H2:</span><span>row 2</span></td>
            <td class="col-2"><span class="label">H3:</span><span>row 3</span></td>
            <td class="col-2"><span class="label">H4:</span><span>row 4</span></td>
            <td class="col-2"><span class="label">H5:</span><span>row 5</span></td>
            <td class="col-2"><span class="label">H6:</span><span>row 6</span></td>
        </tr>
        <tr class="col-12 table-row">
            <td class="col-2"><span class="label">H1:</span><span>row 1</span></td>
            <td class="col-2"><span class="label">H2:</span><span>row 2</span></td>
            <td class="col-2"><span class="label">H3:</span><span>row 3</span></td>
            <td class="col-2"><span class="label">H4:</span><span>row 4</span></td>
            <td class="col-2"><span class="label">H5:</span><span>row 5</span></td>
            <td class="col-2"><span class="label">H6:</span><span>row 6</span></td>
        </tr>
    </tbody>

</table>

<script type="text/javascript">

    (function () {

        function getComponentHeight(element) {
            var paddingTop,
                paddingBottom,
                marginTop,
                marginBottom,
                height,
                adjustedHeight;

            var style = getComputedStyle(element);

            paddingTop = parseInt(style.paddingTop);
            paddingBottom = parseInt(style.paddingBottom);
            marginTop = parseInt(style.marginTop);
            marginBottom = parseInt(style.marginBottom);
            height = parseInt(style.height);

            return paddingTop + paddingBottom + marginTop + marginBottom + height;
        }

        var containers = document.getElementsByClassName('container');

        document.getElementsByClassName('content-title');

        var mq1, mq2, mq3;
        if (matchMedia) {
            mq1 = window.matchMedia("(min-width: 320px) and (max-width: 767px)");
            mq2 = window.matchMedia("(min-width: 768px) and (max-width: 1279px)");
            mq3 = window.matchMedia("(min-width: 1280px)");
            mq1.addListener(WidthChange);
            mq2.addListener(WidthChange);
            mq3.addListener(WidthChange);
            WidthChange();
        }

        function WidthChange() {

            var currentContent = 0;

            if (containers !== undefined && containers.length > 0) {
                var scrollY = window.scrollY;
                var sum = 0;

                for (var i = 0; i < containers.length; i++) {
                    sum += getComponentHeight(containers[i]);
                    if (sum > scrollY + window.innerHeight / 2) {
                        currentContent = i;
                        break;
                    }
                }
            }

            setTimeout(function () {
                var contentHeight = 0;
                for (var i = 0; i <= currentContent; i++) {
                    contentHeight += getComponentHeight(containers[i]);
                }
                window.scrollTo(0, contentHeight - getComponentHeight(containers[currentContent]));

//                smoothScrollTo(0, contentHeight - getComponentHeight(containers[currentContent]));

            }, 300);

            if (mq1.matches) {
                var scrollNavi = document.querySelectorAll(".scroll-navi li");
                var targetScrollY = 0;
                for (var i = 0; i < scrollNavi.length; i++) {
                    if (i === 0) {
                        targetScrollY = 0;
                    } else {
                        targetScrollY += getComponentHeight(containers[i - 1]);
                    }
                    (function (i, targetScrollY) {
                        scrollNavi[i].addEventListener('click', function (e) {
                            window.scrollTo(0, targetScrollY);
                            //smoothScrollTo(0, targetScrollY);
                            e.preventDefault();
                        }, false);
                    })(i, targetScrollY);
                }
            }
        }

        function smoothScrollTo(x, y, speed) {

            if (speed === undefined) {
                speed = Math.abs((y - window.scrollY) / 20);
            }

            var totalContentHeight = 0;
            for (var i = 0; i < containers.length; i++) {
                totalContentHeight += getComponentHeight(containers[i]);
            }
            var canScrollY = totalContentHeight - window.innerHeight;
            var currentScrollY = window.scrollY;
            var targetScrollY = y > canScrollY ? canScrollY : y;
            targetScrollY = targetScrollY < 0 ? 0 : targetScrollY;

            if (window.scrollY < targetScrollY) {
                if (window.scrollY + speed < targetScrollY) {
                    window.scrollTo(x, currentScrollY + speed);
                    requestAnimationFrame(function () {
                        smoothScrollTo(x, targetScrollY, speed);
                    });
                } else {
                    window.scrollTo(x, targetScrollY);
                }
            } else if (window.scrollY > targetScrollY) {
                if (window.scrollY - speed > targetScrollY) {
                    window.scrollTo(0, currentScrollY - speed);
                    requestAnimationFrame(function () {
                        smoothScrollTo(x, targetScrollY, speed);
                    });
                } else {
                    window.scrollTo(x, targetScrollY);
                }
            } else {

            }

        }

    })();
</script>
</body>
</html>